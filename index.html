<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NGen: NGen</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NGen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">NGen </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a> <img src="https://github.com/noaa-owp/ngen/workflows/Testing%20and%20Validation/badge.svg" alt="" style="pointer-events: none;" class="inline"/> <a href="https://noaa-owp.github.io/ngen/"><img src="https://github.com/noaa-owp/ngen/workflows/Documentation/badge.svg" alt="" style="pointer-events: none;" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md3"></a>
Next Gen Water Modeling Framework Prototype</h1>
<p><a href="https://www.youtube.com/watch?v=6XKPX4g9agY"><img src="https://img.youtube.com/vi/6XKPX4g9agY/0.jpg" alt="July 2020 webinar recording" class="inline"/></a></p>
<p><a href="./doc/presentations/Next_Generation_Modeling_System_Seminar-15July2020.pdf">July 2020 webinar slide deck</a></p>
<p><a href="https://noaa-owp.github.io/ngen/">Next Gen Github Pages Documentation</a></p>
<p><b>Description</b>: <br  />
 As we attempt to apply hydrological modeling at different scales, the traditional organizational structure and algorithms of model software begin to interfere with the ability of the model to represent complex and heterogeneous processes at appropriate scales. While it is possible to do so, the code becomes highly specialized, and reasoning about the model and its states becomes more difficult. Model implementations are often the result of taking for granted the availability of a particular form of data <b>and</b> solution &ndash; attempting to map the solution to that data. This framework takes a data centric approach, organizing the data first and mapping appropriate solutions to the existing data.</p>
<p>This framework includes an encapsulation strategy which focuses on the hydrologic data first, and then builds a functional abstraction of hydrologic behavior. This abstraction is naturally recursive, and unlocks a higher level of modeling and reasoning using computational modeling for hydrology. This is done by organizing model components along well-defined flow boundaries, and then implementing strict APIâ€™s to define the movement of water amongst these components. This organization also allows control and orchestration of first-class model components to leverage more sophisticated programming techniques and data structures.</p>
<ul>
<li><b>Technology stack</b>: Core Framework using C++ (minimum standard c++14) to provide polymorphic interfaces with reasonable systems integration.</li>
<li><b>Status</b>: Version 0.1.0 in initial development including interfaces, logical data model, and framework structure. See <a class="el" href="md__c_h_a_n_g_e_l_o_g.html">CHANGELOG</a> for revision details.</li>
</ul>
<h2><a class="anchor" id="autotoc_md4"></a>
Structural Diagrams</h2>
<p><img src="https://raw.githubusercontent.com/NOAA-OWP/ngen/master/doc/images/hy_features_catchment_diagram.png" alt="Catchments" class="inline"/></p>
<p><b>Catchments</b>: Catchments represent arbitrary spatial areas. They are the abstraction used to encapsulate a model. The three marked catchments could use three different models, 3 copies of the same model, or some combination of the previous options.</p>
<p><img src="https://raw.githubusercontent.com/NOAA-OWP/ngen/master/doc/images/realization_relations.png" alt="Realizations" class="inline"/></p>
<p><b>Realizations</b>: Different kinds of catchment realizations can be used to encapsulate different types of models. These models will have different types of relations with neighbors. When a relation exists between two adjacent catchments synchronization is necessary.</p>
<p><img src="https://raw.githubusercontent.com/NOAA-OWP/ngen/master/doc/images/complex_realizations.png" alt="Complex Realizations" class="inline"/></p>
<p><b>Complex Realizations</b>: An important type of catchment realization is the complex catchment realization. This allows a single catchment to be represented by a network of higher detail catchment realizations and their relationships. This allows the modeled area to be represented at multiple levels of detail and supports dynamic high resolution nesting.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Dependencies</h2>
<p>See the <a class="el" href="md_doc_2_d_e_p_e_n_d_e_n_c_i_e_s.html">Dependencies</a>.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Installation</h2>
<p>See <a class="el" href="md__i_n_s_t_a_l_l.html">INSTALL</a>.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Configuration</h2>
<p>To view the compile-time configuration of an pre-compiled NextGen binary use the <code>--info</code> flag, as in <code>ngen --info</code>. for more info see: <a href="https://github.com/NOAA-OWP/ngen/pull/679">https://github.com/NOAA-OWP/ngen/pull/679</a></p>
<h2><a class="anchor" id="autotoc_md8"></a>
Usage</h2>
<p>To run the <em>ngen</em> engine, the following command line positional arguments are supported:</p><ul>
<li><em>catchment_data_path</em> &ndash; path to catchment data geojson input file.</li>
<li><em>catchment subset ids</em> &ndash; list of comma separated ids (NO SPACES!!!) to subset the catchment data, i.e. 'cat-0,cat-1', an empty string or "all" will use all catchments in the hydrofabric</li>
<li><em>nexus_data_path</em> &ndash; path to nexus data geojson input file</li>
<li><em>nexus subset ids</em> &ndash; list of comma separated ids (NO SPACES!!!) to subset the nexus data, i.e. 'nex-0,nex-1', an empty string or "all" will use all nexus points</li>
<li><em>realization_config_path</em> &ndash; path to json configuration file for realization/formulations associated with the hydrofabric inputs</li>
<li><em>partition_config_path</em> &ndash; path to the partition json config file, when using the driver with <a class="el" href="md_doc_2_d_i_s_t_r_i_b_u_t_e_d___p_r_o_c_e_s_s_i_n_g.html">distributed processing</a>.</li>
<li><code>--subdivided-hydrofabric</code> &ndash; an explicit, optional flag, when using the driver with <a class="el" href="md_doc_2_d_i_s_t_r_i_b_u_t_e_d___p_r_o_c_e_s_s_i_n_g.html">distributed processing</a>, to indicate to the driver processes that they should operate on process-specific subdivided hydrofabric files.</li>
</ul>
<p>An example of a complete invocation to run a subset of a hydrofabric. If the realization configuration doesn't contain catchment definitions for the subset keys provided, the default <code>global</code> configuration is used. Alternatively, if the realization configuration contains definitions that are not in the subset (or hydrofabric) keys, then a warning is produced and the formulation isn't created. <code>./cmake-build-debug/ngen ./data/catchment_data.geojson "cat-27,cat-52" ./data/nexus_data.geojson "nex-26,nex-34" ./data/example_realization_config.json</code></p>
<p>To simulate every catchment in the input hydrofabric, leave the subset lists empty, or use "all" i.e.: <code>ngen ./data/catchment_data.geojson "" ./data/nexus_data.geojson "" ./data/refactored_example_realization_config.json</code> <code>ngen ./data/catchment_data.geojson "all" ./data/nexus_data.geojson "all" ./data/refactored_example_realization_config.json</code></p>
<p>Examples specific to running with with distributed processing can be found <a href="doc/DISTRIBUTED_PROCESSING.md#examples">here</a>.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
How to test the software</h2>
<p>The project uses the <b>Google Test</b> framework for creating automated tests for C++ code.</p>
<p>To execute the full collection of automated C++ tests, run the <code>test_all</code> target in <b>CMake</b>, then execute the generated executable. Alternatively, replace <code>test_all</code> with <code>test_unit</code> or <code>test_integration</code> to run only those tests. For example: </p><pre class="fragment">cmake --build cmake-build-debug --target test_all -- -j 4
./cmake-build-debug/test/test_all
</pre><p> Or, if the build system has not yet been properly generated: </p><pre class="fragment">git submodule update --init --recursive -- test/googletest
cmake -DCMAKE_BUILD_TYPE=Debug -DNGEN_WITH_TESTS:BOOL=ON -B cmake-build-debug -S .
cmake --build cmake-build-debug --target test_all -- -j 4
./cmake-build-debug/test/test_all
</pre><p> See the <a class="el" href="md_test_2_r_e_a_d_m_e.html">Testing ReadMe</a> file and <a href="https://github.com/NOAA-OWP/ngen/wiki/NGen-Tutorial">wiki/Quickstart</a> for a more thorough discussion of testing.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
How to debug the software</h2>
<p>This is all developed via <b>CMake</b>, so a specific setting must be active within the root <code>CMakeList.txt</code> file: </p><pre class="fragment">target_compile_options(ngen PUBLIC -g)
</pre><p> This will ensure that ngen and all of the code that is compiled with it has debugging flags enabled. From there, the application may be run via <code>gdb</code>, <code>lldb</code>, or through your IDE.</p>
<p>If you do not have administrative rights on your workstation, there's a chance you do <em>not</em> have access to <code>gdb</code> or <code>lldb</code>, meaning that you cannot step through your code and inspect variables. To get around this, you can use GitPod to start an editor (based on VSCode) in your browser and edit and debug to your heart's content. You can access an individualized GitPod environment through: <a href="https://gitpod.io/#https://github.com/">https://gitpod.io/#https://github.com/</a>&lt;your github username&gt;/ngen. Entering it for the first time will generate a new git branch.</p>
<p>There are a few things required, however. When you first enter, gitpod will ask you if you want to set up your environment. Let it create a <code>.yml</code> configuration file. It will then ask if you want it to create a custom docker image. Say yes, then choose the default image. At the end, you should have a <code>.gitpod.yml</code> and <code>.gitpod.dockerfile</code> at the root of the project.</p>
<p>Next, you will need to add the above <code>target_compile_options(ngen PUBLIC -g)</code> just about anywhere in the <code>CMakeLists.txt</code> file within the root of your project.</p>
<p>Next, you will need to make sure that <b>all</b> dependencies are installed within your environment. The image GitPod supplies uses an application name HomeBrew to allow you to install dependencies. You will need to run: </p><pre class="fragment">brew install boost
</pre><p> to proceed further. Now clear all of your previously built binaries and build your application (<code>ngen</code> or any test routine that you're interested in, such as <code>test_all</code>).</p>
<p>A debugging extension should be installed into your workspace. Select the bottom icon on the left hand side of your screen; it should look like a box with a square in it. CodeLLDB is a good extension to use.</p>
<p>Lastly, a debugging configuration must be set up. There is an icon on the left hand side of your screen that should be a bug with a slash through it, somewhat like a 'No Parking' sign. If you click it, it will open a debugging tab on the left hand side of your screen. Within it, you should see a play button next to a drop down menu that says 'No Configurations'. Click on that, then click on the option named "Add Configuration...". This will create a file named <code>launch.json</code>. Within it, add a configuration so that it looks like:</p>
<pre class="fragment">{
  // Use IntelliSense to learn about possible attributes.
  // Hover to view descriptions of existing attributes.
  "version": "0.2.0",
  "configurations": [
    {
        "name": "ngen",
        "type": "lldb",
        "request": "launch",
        "program": "${workspaceFolder}/&lt;your build directory&gt;/ngen",
        "args": [],
    }
  ]
}
</pre><p> You will now have the configuration named <code>ngen</code> after saving your <code>launch.json</code> file. You may now add a break point within your code by clicking to the left of the line number within your code. This should make a red circle appear. Now, when you run it by clicking the play button in the debugging window, your code will stop on the line where you put your break point, as long as it executes code. It will <b>not</b> stop on whitespace or comments.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Known issues</h2>
<p>Document any known significant shortcomings with the software.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Getting help</h2>
<p>Instruct users how to get help with this software; this might include links to an issue tracker, wiki, mailing list, etc.</p>
<p><b>Example</b></p>
<p>If you have questions, concerns, bug reports, etc, please file an issue in this repository's Issue Tracker.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Getting involved</h2>
<p>This section should detail why people should get involved and describe key areas you are currently focusing on; e.g., trying to get feedback on features, fixing certain bugs, building important pieces, etc.</p>
<p>General instructions on <em>how</em> to contribute should be stated with a link to <a class="el" href="md__c_o_n_t_r_i_b_u_t_i_n_g.html">CONTRIBUTING</a>.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md15"></a>
Open source licensing info</h2>
<ol type="1">
<li><a class="el" href="md__t_e_r_m_s.html">TERMS</a></li>
<li>[LICENSE](LICENSE)</li>
</ol>
<hr  />
<h2><a class="anchor" id="autotoc_md17"></a>
Credits and references</h2>
<ol type="1">
<li>Projects that inspired you</li>
<li>Related projects</li>
<li>Books, papers, talks, or other sources that have meaningful impact or influence on this project </li>
</ol>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Jun 21 2024 18:29:47 for NGen by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
